include:
  - 1_spatial.yml
  - 2_observations.yml
  - 3_drivers.yml
  - 4_forecasts.yml

packages:
  - yaml
  - dplyr
  - tidyr
  - meddle # at least v0.0.12
  - readr
  - feather
  - rgdal
  - stringr
  - sf
  - sbtools
  - dssecrets
  - scipiper
  - tidyverse

sources:
  #- src/spatial_utils.R
  - src/sb_utils.R
  - src/sb_functions.R
  - src/spatial_functions.R

targets:
  all:
    depends:
      # - 00_parent_sb_xml
      - log/00_parent_sb.csv
      # - 01_spatial_sb_xml
      - log/01_spatial_sb_data.csv
      # - 02_observations_sb_xml
      - log/02_observations_sb_data.csv
      # - 03_drivers_sb_xml
      - log/03_drivers_sb_data.csv
      # - 04_forecasts_sb_xml
      - log/04_forecasts_sb_data.csv
  
# Not longer using this target as it is the fgdc metadata xml that will contain metadata info
  # out_xml/00_parent.xml:
  #   command: render(filename = target_name,
  #     "in_text/text_SHARED.yml",
  #     "in_text/text_00_parent.yml")
  #       river_metadata_verts)

  # Build xml for parent item
  out_xml/00_parent_fgdc_metadata.xml:
    command: render(
      filename = target_name,
      "in_text/text_SHARED.yml",
      "in_text/text_00_parent.yml",
      river_metadata_segs)

  ## Push metadata xml to sb
  log/00_parent_sb.csv:
    command: sb_replace_files(
      filename = target_name,
      sb_id = sbid_00_parent,
      sources = 'src/sb_utils.R',
      'out_xml/00_parent_fgdc_metadata.xml')

  ## Original xml metadata target for parent - Leaving out for now
  # 00_parent_sb_xml:
  #   command: sb_render_post_xml(sbid_00_parent,
  #     xml_file = I('00_parent.xml'),
  #     "in_text/text_SHARED.yml",
  #     "in_text/text_00_parent.yml",
  #     river_metadata_verts)

  ## Build xml for spatial
  out_xml/01_spatial_fgdc_metadata.xml:
    command: render(filename = target_name,
      "in_text/text_SHARED.yml",
      "in_text/text_01_spatial.yml",
      river_metadata_segs)

  ## Push all spatial data + metadata xml to sb
  log/01_spatial_sb_data.csv:
    command: sb_replace_files(
      filename = target_name,
      sb_id = sbid_01_spatial,
      sources = "src/sb_utils.R",
      "out_data/XX_spatial1.zip",
      "out_data/XX_spatial2.zip",
      "out_xml/01_spatial_fgdc_metadata.xml")

  ## original xml metadata target for spatial - Leaving out for now
  # 01_spatial_sb_xml:
  #   command: sb_render_post_xml(
  #     sbid_01_spatial,
  #     xml_file = I('01_spatial_sb.xml'),
  #     "in_text/text_SHARED.yml",
  #     "in_text/text_01_spatial.yml",
  #     river_metadata_segs)

  ## build metadata xml for observations
  out_xml/02_observations_fgdc_metadata.xml:
    command: render(filename = target_name,
      "in_text/text_SHARED.yml",
      "in_text/text_02_observations.yml",
      river_metadata_segs)

  ## Push all observations data + metadata xml to sb
  log/02_observations_sb_data.csv:
    command: sb_replace_files(
      filename = target_name,
      sb_id = sbid_02_observations,
      sources = "src/sb_utils.R",
      "out_data/XX_observations1.zip",
      "out_data/XX_observations2.zip",
      "out_xml/02_observations_fgdc_metadata.xml")

  ## original xml metadata target for observations - Leaving out for now
  # 02_observations_sb_xml:
  #   command: sb_render_post_xml(sbid_02_observations,
  #     xml_file = I('02_observations.xml'),
  #     "in_text/text_SHARED.yml",
  #     "in_text/text_02_observations.yml",
  #     river_metadata_segs)

  ## Build metadata xml for driver data
  out_xml/03_drivers_fgdc_metadata.xml:
    command: render(filename = target_name,
      "in_text/text_SHARED.yml",
      "in_text/text_03_drivers.yml",
      river_metadata_segs
      )

  ## Push all driver data + xml to sb
  log/03_drivers_sb_data.csv:
    command: sb_replace_files(
      filename = target_name,
      sb_id = sbid_03_drivers,
      sources = 'src/sb_utils.R',
      'out_data/XX_drivers1.zip',
      'out_data/XX_drivers2.zip',
      'out_xml/03_drivers_fgdc_metadata.xml'
      )

  # 03_drivers_sb_xml:
  #   command: sb_render_post_xml(sbid_03_drivers,
  #     xml_file = I('03_drivers.xml'),
  #     "in_text/text_SHARED.yml",
  #     "in_text/text_03_drivers.yml")
  #      river_metadata_verts

  ## Push all forecast data + xml to sb
  log/04_forecasts_sb_data.csv:
    command: sb_replace_files(
      filename = target_name,
      sb_id = sbid_04_forecasts,
      sources = 'src/sb_utils.R',
      'out_data/XX_forecasts1.zip',
      'out_data/XX_forecasts2.zip',
      )

  # 04_forecasts_sb_xml:
  #   command: sb_render_post_xml(sbid_04_forecasts,
  #     xml_file = I('04_forecasts.xml'),
  #     "in_text/text_SHARED.yml",
  #     "in_text/text_04_forecasts.yml")
  #      river_metadata_verts


  # ------ SB IDs --------

  sbid_00_parent:
    command: c(I('61ddfd54d34ed79294021ad8')) # #XX_sb_id_parent

  sbid_01_spatial:
    command: c(I('636187b3d34ebe44250656b0')) #XX_sb_id_spatial

  sbid_02_observations:
    command: c(I('636187ced34ebe44250656b3')) #XX_sb_id_observations

  sbid_03_drivers:
    command: c(I('6361881bd34ebe44250656b8')) #XX_sb_id_drivers 

  sbid_04_forecasts:
    command: c(I('6361882ed34ebe44250656ba')) #XX_sb_id_forecasts
